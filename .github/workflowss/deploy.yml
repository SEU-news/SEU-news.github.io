name: Flask Static Deploy

on:
  push:
    branches: [ main ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
    
    # 1. æ£€å‡ºä»£ç 
    - name: Checkout ğŸ›ï¸
      uses: actions/checkout@v4

    # 2. è®¾ç½®Pythonç¯å¢ƒ
    - name: Set up Python 3.10
      uses: actions/setup-python@v4
      with:
        python-version: "3.10"

    # 3. å®‰è£…ä¾èµ–å’Œå†»ç»“åº”ç”¨
    - name: Install dependencies & freeze Flask ğŸ”§
      run: |
        pip install -r requirements.txt
        pip install frozen-flask
        python freeze.py  # æ‰§è¡Œé™æ€ç”Ÿæˆè„šæœ¬

    # 4. éƒ¨ç½²åˆ°gh-pages
    - name: Deploy to GitHub Pages ğŸš€
      uses: JamesIves/github-pages-deploy-action@v4.5.0
      with:
        branch: gh-pages       # ç›®æ ‡åˆ†æ”¯
        folder: build          # Frozen-Flaské»˜è®¤è¾“å‡ºç›®å½•
        clean: true            # éƒ¨ç½²å‰æ¸…ç©ºç›®æ ‡åˆ†æ”¯å†…å®¹
        token: ${{ secrets.GITHUB_TOKEN }}
